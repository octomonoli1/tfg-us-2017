{"version":3,"sources":["globalEvalStyles.js"],"names":[],"mappings":";AAAA;;;;;;;;;;;;;;;;;;;;KAQM;;;;;mBAQE,mBAAI,MAAM,cAAc;AAC9B,OAAI,QAAQ,SAAS,aAAT,CAAuB,OAAvB,CAAR,CAD0B;AAE9B,SAAM,SAAN,GAAkB,IAAlB,CAF8B;AAG9B,OAAI,YAAJ,EAAkB;AACjB,iBAAa,KAAb,EADiB;IAAlB,MAEO;AACN,aAAS,IAAT,CAAc,WAAd,CAA0B,KAA1B,EADM;IAFP;AAKA,UAAO,KAAP,CAR8B;;;AAR1B,mBA4BE,2BAAQ,MAAM,cAAc,cAAc;AAChD,OAAI,OAAO,SAAS,aAAT,CAAuB,MAAvB,CAAP,CAD4C;AAEhD,QAAK,GAAL,GAAW,YAAX,CAFgD;AAGhD,QAAK,IAAL,GAAY,IAAZ,CAHgD;AAIhD,oBAAiB,QAAjB,CAA0B,IAA1B,EAAgC,YAAhC,EAA8C,YAA9C,EAJgD;AAKhD,UAAO,IAAP,CALgD;;;AA5B5C,mBA6CE,6BAAS,OAAO,cAAc,cAAc;AAClD,OAAI,WAAW,SAAX,QAAW,GAAW;AACzB,oBAAgB,cAAhB,CADyB;IAAX,CADmC;AAIlD,OAAI,MAAM,GAAN,IAAa,MAAM,GAAN,KAAc,YAAd,EAA4B;AAC5C,iBAAM,QAAN,CAAe,QAAf,EAD4C;AAE5C,WAF4C;IAA7C;;AAKA,OAAI,MAAM,OAAN,KAAkB,OAAlB,EAA2B;AAC9B,iBAAM,QAAN,CAAe,QAAf,EAD8B;IAA/B,MAEO;AACN,kBAAI,IAAJ,CAAS,KAAT,EAAgB,MAAhB,EAAwB,QAAxB,EADM;AAEN,kBAAI,IAAJ,CAAS,KAAT,EAAgB,OAAhB,EAAyB,QAAzB,EAFM;IAFP;;AAOA,OAAI,YAAJ,EAAkB;AACjB,iBAAa,KAAb,EADiB;IAAlB,MAEO;AACN,aAAS,IAAT,CAAc,WAAd,CAA0B,KAA1B,EADM;IAFP;;AAMA,UAAO,KAAP,CAtBkD;;;AA7C9C,mBA8EE,iDAAmB,SAAS,cAAc,cAAc;AAC9D,OAAI,SAAS,QAAQ,gBAAR,CAAyB,YAAzB,CAAT,CAD0D;AAE9D,OAAI,OAAO,MAAP,KAAkB,CAAlB,IAAuB,YAAvB,EAAqC;AACxC,iBAAM,QAAN,CAAe,YAAf,EADwC;AAExC,WAFwC;IAAzC;;AAKA,OAAI,YAAY,CAAZ,CAP0D;AAQ9D,OAAI,WAAW,SAAX,QAAW,GAAW;AACzB,QAAI,gBAAgB,EAAE,SAAF,KAAgB,OAAO,MAAP,EAAe;AAClD,kBAAM,QAAN,CAAe,YAAf,EADkD;KAAnD;IADc,CAR+C;AAa9D,QAAK,IAAI,IAAI,CAAJ,EAAO,IAAI,OAAO,MAAP,EAAe,GAAnC,EAAwC;AACvC,qBAAiB,QAAjB,CAA0B,OAAO,CAAP,CAA1B,EAAqC,QAArC,EAA+C,YAA/C,EADuC;IAAxC;;;SA3FI;;;mBAiGS","file":"../../../node_modules/metal-dom/src/globalEvalStyles.js","sourcesContent":["'use strict';\n\nimport { async } from 'metal';\nimport dom from './dom';\n\n/**\n * Utility functions for running styles.\n */\nclass globalEvalStyles {\n\t/**\n\t * Evaluates the given style.\n\t * @param {string} text\n\t * @param {function()=} opt_appendFn Optional function to append the node\n\t *   into document.\n\t * @return {Element} style\n\t */\n\tstatic run(text, opt_appendFn) {\n\t\tvar style = document.createElement('style');\n\t\tstyle.innerHTML = text;\n\t\tif (opt_appendFn) {\n\t\t\topt_appendFn(style);\n\t\t} else {\n\t\t\tdocument.head.appendChild(style);\n\t\t}\n\t\treturn style;\n\t}\n\n\t/**\n\t * Evaluates the given style file.\n\t * @param {string} href The file's path.\n\t * @param {function()=} opt_callback Optional function to be called\n\t *   when the styles has been run.\n\t * @param {function()=} opt_appendFn Optional function to append the node\n\t *   into document.\n\t * @return {Element} style\n\t */\n\tstatic runFile(href, opt_callback, opt_appendFn) {\n\t\tvar link = document.createElement('link');\n\t\tlink.rel = 'stylesheet';\n\t\tlink.href = href;\n\t\tglobalEvalStyles.runStyle(link, opt_callback, opt_appendFn);\n\t\treturn link;\n\t}\n\n\t/**\n\t * Evaluates the code referenced by the given style/link element.\n\t * @param {!Element} style\n\t * @param {function()=} opt_callback Optional function to be called\n\t *   when the script has been run.\n\t * @param {function()=} opt_appendFn Optional function to append the node\n\t *   into document.\n\t *  @return {Element} style\n\t */\n\tstatic runStyle(style, opt_callback, opt_appendFn) {\n\t\tvar callback = function() {\n\t\t\topt_callback && opt_callback();\n\t\t};\n\t\tif (style.rel && style.rel !== 'stylesheet') {\n\t\t\tasync.nextTick(callback);\n\t\t\treturn;\n\t\t}\n\n\t\tif (style.tagName === 'STYLE') {\n\t\t\tasync.nextTick(callback);\n\t\t} else {\n\t\t\tdom.once(style, 'load', callback);\n\t\t\tdom.once(style, 'error', callback);\n\t\t}\n\n\t\tif (opt_appendFn) {\n\t\t\topt_appendFn(style);\n\t\t} else {\n\t\t\tdocument.head.appendChild(style);\n\t\t}\n\n\t\treturn style;\n\t}\n\n\t/**\n\t * Evaluates any style present in the given element.\n\t * @params {!Element} element\n\t * @param {function()=} opt_callback Optional function to be called when the\n\t *   style has been run.\n\t * @param {function()=} opt_appendFn Optional function to append the node\n\t *   into document.\n\t */\n\tstatic runStylesInElement(element, opt_callback, opt_appendFn) {\n\t\tvar styles = element.querySelectorAll('style,link');\n\t\tif (styles.length === 0 && opt_callback) {\n\t\t\tasync.nextTick(opt_callback);\n\t\t\treturn;\n\t\t}\n\n\t\tvar loadCount = 0;\n\t\tvar callback = function() {\n\t\t\tif (opt_callback && ++loadCount === styles.length) {\n\t\t\t\tasync.nextTick(opt_callback);\n\t\t\t}\n\t\t};\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tglobalEvalStyles.runStyle(styles[i], callback, opt_appendFn);\n\t\t}\n\t}\n}\n\nexport default globalEvalStyles;\n"],"sourceRoot":"/source/"}