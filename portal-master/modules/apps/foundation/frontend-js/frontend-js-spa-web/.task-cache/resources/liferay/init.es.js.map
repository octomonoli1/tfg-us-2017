{"version":3,"sources":["/source/init.es.js"],"names":[],"mappings":";AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;AAUA,KAAI,UAAU,SAAV,OAAU,CAAS,QAAT,EAAmB;AAChC,MAAI,MAAM,mBAAN,CAD4B;;AAGhC,MAAI,SAAJ,CACC,CACC;AACC,qCADD;AAEC,SAAM,cAAS,GAAT,EAAc;AACnB,QAAI,MAAM,kBAAQ,GAAR,CAAN,CADe;;AAGnB,QAAI,gBAAgB,kBAAQ,QAAQ,GAAR,CAAY,aAAZ,CAAxB,CAHe;;AAKnB,QAAI,WAAW,cAAc,WAAd,MAA+B,OAAO,QAAP,CAAgB,QAAhB,CAL3B;;AAOnB,QAAI,CAAC,IAAI,iBAAJ,CAAsB,QAAtB,CAAD,EAAkC;AACrC,YAAO,KAAP,CADqC;KAAtC;;AAIA,WAAO,IAAI,iBAAJ,CAAsB,eAAtB,MAA2C,GAA3C,CAXY;IAAd;GAHR,EAiBC;AACC,qCADD;AAEC,SAAM,cAAS,GAAT,EAAc;AACnB,QAAI,IAAI,OAAJ,CAAY,aAAa,WAAb,EAAZ,MAA4C,CAA5C,EAA+C;AAClD,YAAO,KAAP,CADkD;KAAnD;;AAIA,QAAI,WAAW,QAAQ,GAAR,CAAY,aAAZ,CAA0B,IAA1B,CACd,UAAC,YAAD;YAAkB,IAAI,OAAJ,CAAY,YAAZ,MAA8B,CAA9B;KAAlB,CADG,CALe;;AASnB,QAAI,QAAJ,EAAc;AACb,YAAO,KAAP,CADa;KAAd;;AAIA,QAAI,MAAM,kBAAQ,GAAR,CAAN,CAbe;;AAenB,QAAI,YAAY,IAAI,iBAAJ,CAAsB,eAAtB,CAAZ,CAfe;;AAiBnB,WAAO,cAAc,GAAd,IAAqB,CAAC,SAAD,CAjBT;IAAd;GAnBR,CADD,EAHgC;;AA8ChC,UAAQ,IAAR,CAAa,UAAb,GAA0B,UAAS,IAAT,EAAe;AACxC,mBAAM,QAAN,CACC,YAAM;AACL,QAAI,cAAc,KAAK,MAAL,EAAd,CADC;AAEL,QAAI,MAAM,YAAY,MAAZ,CAFL;;AAIL,QAAI,IAAI,WAAJ,CAAgB,GAAhB,KAAyB,YAAY,MAAZ,KAAuB,KAAvB,IAAiC,CAAC,IAAI,oBAAJ,CAAyB,WAAzB,CAAD,EAAwC;AACrG,aAAQ,IAAR,CAAa,aAAb,GAA6B,KAA7B,CADqG;;AAGrG,uBAAQ,mBAAR,GAA8B,WAA9B,CAHqG;;AAKrG,SAAI,QAAJ,CAAa,gBAAM,UAAN,CAAiB,GAAjB,CAAb,EALqG;KAAtG,MAOK;AACJ,iBAAY,MAAZ,GADI;KAPL;IAJD,CADD,CADwC;GAAf,CA9CM;;AAkEhC,UAAQ,GAAR,CAAY,GAAZ,GAAkB,GAAlB,CAlEgC;;AAoEhC,UAAQ,IAAR,CAAa,UAAb,EApEgC;;AAsEhC,SAAO,GAAP,CAtEgC;EAAnB;;mBAyEC;AACd,QAAM,cAAS,QAAT,EAAmB;;;AACxB,OAAI,kBAAQ,QAAR,CAAiB,UAAjB,IAA+B,SAA/B,EAA0C;AAC7C,sBAAQ,QAAR,CAAiB,gBAAjB,CACC,kBADD,EAEC,YAAM;AACL,cAAS,IAAT,QAAoB,SAApB,EADK;KAAN,CAFD,CAD6C;IAA9C,MAQK;AACJ,aAAS,IAAT,CAAc,IAAd,EAAoB,SAApB,EADI;IARL;GADK","sourcesContent":["'use strict';\n\nimport ActionURLScreen from './screen/ActionURLScreen.es';\nimport App from './app/App.es';\nimport async from 'metal/src/async/async';\nimport globals from 'senna/src/globals/globals';\nimport RenderURLScreen from './screen/RenderURLScreen.es';\nimport Uri from 'metal-uri/src/Uri';\nimport utils from 'senna/src/utils/utils';\n\nvar initSPA = function(callback) {\n\tlet app = new App();\n\n\tapp.addRoutes(\n\t\t[\n\t\t\t{\n\t\t\t\thandler: ActionURLScreen,\n\t\t\t\tpath: function(url) {\n\t\t\t\t\tvar uri = new Uri(url);\n\n\t\t\t\t\tvar loginRedirect = new Uri(Liferay.SPA.loginRedirect);\n\n\t\t\t\t\tvar hostname = loginRedirect.getHostname() || window.location.hostname;\n\n\t\t\t\t\tif (!app.isLinkSameOrigin_(hostname)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn uri.getParameterValue('p_p_lifecycle') === '1';\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\thandler: RenderURLScreen,\n\t\t\t\tpath: function(url) {\n\t\t\t\t\tif (url.indexOf(themeDisplay.getPathMain()) === 0) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar excluded = Liferay.SPA.excludedPaths.some(\n\t\t\t\t\t\t(excludedPath) => url.indexOf(excludedPath) === 0\n\t\t\t\t\t);\n\n\t\t\t\t\tif (excluded) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar uri = new Uri(url);\n\n\t\t\t\t\tvar lifecycle = uri.getParameterValue('p_p_lifecycle');\n\n\t\t\t\t\treturn lifecycle === '0' || !lifecycle;\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t);\n\n\tLiferay.Util.submitForm = function(form) {\n\t\tasync.nextTick(\n\t\t\t() => {\n\t\t\t\tlet formElement = form.getDOM();\n\t\t\t\tlet url = formElement.action;\n\n\t\t\t\tif (app.canNavigate(url) && (formElement.method !== 'get') && !app.isInPortletBlacklist(formElement)) {\n\t\t\t\t\tLiferay.Util._submitLocked = false;\n\n\t\t\t\t\tglobals.capturedFormElement = formElement;\n\n\t\t\t\t\tapp.navigate(utils.getUrlPath(url));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tformElement.submit();\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t};\n\n\tLiferay.SPA.app = app;\n\n\tLiferay.fire('SPAReady');\n\n\treturn app;\n};\n\nexport default {\n\tinit: function(callback) {\n\t\tif (globals.document.readyState == 'loading') {\n\t\t\tglobals.document.addEventListener(\n\t\t\t\t'DOMContentLoaded',\n\t\t\t\t() => {\n\t\t\t\t\tcallback.call(this, initSPA());\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse {\n\t\t\tcallback.call(this, initSPA());\n\t\t}\n\t}\n};"]}