{"version":3,"sources":["/source/EventScreen.es.js"],"names":[],"mappings":"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","sourcesContent":["'use strict';\n\nimport HtmlScreen from 'senna/src/screen/HtmlScreen';\nimport globals from 'senna/src/globals/globals';\nimport {CancellablePromise} from 'metal-promise/src/promise/Promise';\nimport Utils from '../util/Utils.es';\n\nclass EventScreen extends HtmlScreen {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.cacheable = false;\n\t\tthis.timeout = Liferay.PropsValues.JAVASCRIPT_SINGLE_PAGE_APPLICATION_TIMEOUT;\n\t}\n\n\tdispose() {\n\t\tsuper.dispose();\n\n\t\tLiferay.fire(\n\t\t\t'screenDispose',\n\t\t\t{\n\t\t\t\tapp: Liferay.SPA.app,\n\t\t\t\tscreen: this\n\t\t\t}\n\t\t);\n\t}\n\n\tactivate() {\n\t\tsuper.activate();\n\n\t\tLiferay.fire(\n\t\t\t'screenActivate',\n\t\t\t{\n\t\t\t\tapp: Liferay.SPA.app,\n\t\t\t\tscreen: this\n\t\t\t}\n\t\t);\n\t}\n\n\taddCache(content) {\n\t\tsuper.addCache(content);\n\n\t\tthis.cacheLastModified = (new Date()).getTime();\n\t}\n\n\tcheckRedirectPath(redirectPath) {\n\t\tvar app = Liferay.SPA.app;\n\n\t\tif (!globals.capturedFormElement && !app.findRoute(redirectPath)) {\n\t\t\twindow.location.href = redirectPath;\n\t\t}\n\t}\n\n\tdeactivate() {\n\t\tsuper.deactivate();\n\n\t\tLiferay.fire(\n\t\t\t'screenDeactivate',\n\t\t\t{\n\t\t\t\tapp: Liferay.SPA.app,\n\t\t\t\tscreen: this\n\t\t\t}\n\t\t);\n\t}\n\n\tbeforeScreenFlip() {\n\t\tLiferay.fire(\n\t\t\t'beforeScreenFlip',\n\t\t\t{\n\t\t\t\tapp: Liferay.SPA.app,\n\t\t\t\tscreen: this\n\t\t\t}\n\t\t);\n\t}\n\n\tcopyBodyAttributes() {\n\t\tvar virtualBody = this.virtualDocument.querySelector('body');\n\n\t\tdocument.body.className = virtualBody.className;\n\t\tdocument.body.onload = virtualBody.onload;\n\t}\n\n\tflip(surfaces) {\n\t\tthis.copyBodyAttributes();\n\n\t\treturn CancellablePromise.resolve(Utils.resetAllPortlets())\n\t\t\t.then(CancellablePromise.resolve(this.beforeScreenFlip()))\n\t\t\t.then(super.flip(surfaces))\n\t\t\t.then(\n\t\t\t\t() => {\n\t\t\t\t\tthis.runBodyOnLoad();\n\n\t\t\t\t\tLiferay.fire(\n\t\t\t\t\t\t'screenFlip',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tapp: Liferay.SPA.app,\n\t\t\t\t\t\t\tscreen: this\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\t}\n\n\tgetCache() {\n\t\tvar app = Liferay.SPA.app;\n\n\t\tif (app.isCacheEnabled() && !app.isScreenCacheExpired(this)) {\n\t\t\treturn super.getCache();\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetCacheLastModified() {\n\t\treturn this.cacheLastModified;\n\t}\n\n\tisValidResponseStatusCode(statusCode) {\n\t\tvar validStatusCodes = Liferay.SPA.app.getValidStatusCodes();\n\n\t\treturn super.isValidResponseStatusCode(statusCode) || (validStatusCodes.indexOf(statusCode) > -1);\n\t}\n\n\tload(path) {\n\t\treturn super.load(path)\n\t\t\t.then(\n\t\t\t\t(content) => {\n\t\t\t\t\tvar redirectPath = this.beforeUpdateHistoryPath(path);\n\n\t\t\t\t\tthis.checkRedirectPath(redirectPath);\n\n\t\t\t\t\tLiferay.fire(\n\t\t\t\t\t\t'screenLoad',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tapp: Liferay.SPA.app,\n\t\t\t\t\t\t\tcontent: content,\n\t\t\t\t\t\t\tscreen: this\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\treturn content;\n\t\t\t\t}\n\t\t\t);\n\t}\n\n\trunBodyOnLoad() {\n\t\tvar onLoad = document.body.onload;\n\n\t\tif (onLoad) {\n\t\t\tonLoad();\n\t\t}\n\t}\n}\n\nexport default EventScreen;"]}