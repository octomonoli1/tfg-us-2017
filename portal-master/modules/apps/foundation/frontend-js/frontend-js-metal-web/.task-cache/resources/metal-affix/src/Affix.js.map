{"version":3,"sources":["/source/Affix.js"],"names":[],"mappings":";AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAWM,K;;;;;;;AAIL,iBAAY,UAAZ,EAAwB;AAAA;;AAAA,gDACvB,kBAAM,UAAN,CADuB;;AAGvB,OAAI,CAAC,MAAM,QAAX,EAAqB;AACpB,UAAM,QAAN,GAAiB,sBAAjB;AACA,UAAM,MAAN,GAAe,8BAAyB,QAAzB,EAAmC,MAAM,QAAzC,EAAmD,IAAnD,EAAyD;AACvE,aAAQ;AAD+D,KAAzD,CAAf;AAGA;;;;;;;AAOD,SAAK,aAAL,GAAqB,IAArB;;;;;;;AAOA,SAAK,aAAL,GAAqB,MAAM,QAAN,CAAe,EAAf,CAAkB,QAAlB,EAA4B,MAAK,aAAL,CAAmB,IAAnB,OAA5B,CAArB;;AAEA,SAAK,EAAL,CAAQ,gBAAR,EAA0B,MAAK,aAA/B;AACA,SAAK,EAAL,CAAQ,kBAAR,EAA4B,MAAK,aAAjC;AACA,SAAK,EAAL,CAAQ,qBAAR,EAA+B,MAAK,aAApC;AACA,SAAK,aAAL;AA3BuB;AA4BvB;;;;;;;kBAKD,e,8BAAkB;AACjB,YAAI,aAAJ,CAAkB,KAAK,OAAvB,EAAgC,MAAM,QAAN,CAAe,MAAf,GAAwB,GAAxB,GAA8B,MAAM,QAAN,CAAe,OAA7C,GAAuD,GAAvD,GAA6D,MAAM,QAAN,CAAe,GAA5G;AACA,QAAK,aAAL,CAAmB,OAAnB;AACA,oBAAM,eAAN;AACA,G;;kBAMD,a,4BAAgB;AACf,OAAI,KAAK,kBAAL,EAAJ,EAA+B;AAC9B,SAAK,YAAL,CAAkB,MAAM,QAAN,CAAe,GAAjC;AACA,IAFD,MAEO,IAAI,KAAK,qBAAL,EAAJ,EAAkC;AACxC,SAAK,YAAL,CAAkB,MAAM,QAAN,CAAe,MAAjC;AACA,IAFM,MAEA;AACN,SAAK,YAAL,CAAkB,MAAM,QAAN,CAAe,OAAjC;AACA;AACD,G;;kBAOD,qB,oCAAwB;AACvB,OAAI,CAAC,gBAAK,KAAL,CAAW,KAAK,YAAhB,CAAL,EAAoC;AACnC,WAAO,KAAP;AACA;AACD,OAAI,eAAe,mBAAS,SAAT,CAAmB,KAAK,aAAxB,CAAnB;AACA,OAAI,4BAA4B,mBAAS,eAAT,CAAyB,KAAK,aAA9B,CAAhC;AACA,UAAO,mBAAS,YAAT,CAAsB,KAAK,aAA3B,IAA4C,yBAA5C,IAAyE,eAAe,KAAK,YAApG;AACA,G;;kBAOD,kB,iCAAqB;AACpB,OAAI,CAAC,gBAAK,KAAL,CAAW,KAAK,SAAhB,CAAL,EAAiC;AAChC,WAAO,KAAP;AACA;AACD,UAAO,mBAAS,YAAT,CAAsB,KAAK,aAA3B,KAA6C,KAAK,SAAzD;AACA,G;;kBAMD,Y,yBAAa,Q,EAAU;AACtB,OAAI,KAAK,aAAL,KAAuB,QAA3B,EAAqC;AACpC,aAAI,UAAJ,CAAe,KAAK,OAApB,EAA6B,QAA7B;AACA,aAAI,aAAJ,CAAkB,KAAK,OAAvB,EAAgC,KAAK,aAArC;AACA,SAAK,aAAL,GAAqB,QAArB;AACA;AACD,G;;;;;;;;;AAOF,OAAM,QAAN,GAAiB;AAChB,OAAK,WADW;AAEhB,UAAQ,cAFQ;AAGhB,WAAS;AAHO,EAAjB;;AAMA,OAAM,KAAN,GAAc;;;;;;AAMb,iBAAe;AACd,WAAQ,SAAI,SADE;AAEd,UAAO;AAFO,GANF;;;;;;AAeb,aAAW;AACV,cAAW,gBAAK;AADN,GAfE;;;;;;AAuBb,gBAAc;AACb,cAAW,gBAAK;AADH,GAvBD;;;;;;AA+Bb,WAAS;AACR,WAAQ,SAAI;AADJ;AA/BI,EAAd;;mBAoCe,K;AACoD,yBAAc,QAAd,CAAuB,OAAvB,EAAgC,KAAhC","sourcesContent":["'use strict';\n\nimport core from 'metal';\nimport { dom, DomEventEmitterProxy } from 'metal-dom';\nimport State from 'metal-state';\nimport EventEmitter from 'metal-events';\nimport Position from 'metal-position';\n\n/**\n * Affix utility.\n */\nclass Affix extends State {\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor(opt_config) {\n\t\tsuper(opt_config);\n\n\t\tif (!Affix.emitter_) {\n\t\t\tAffix.emitter_ = new EventEmitter();\n\t\t\tAffix.proxy_ = new DomEventEmitterProxy(document, Affix.emitter_, null, {\n\t\t\t\tscroll: true\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Holds the last position.\n\t\t * @type {Position.Bottom|Position.Default|Position.Top}\n\t\t * @private\n\t\t */\n\t\tthis.lastPosition_ = null;\n\n\t\t/**\n\t\t * Holds event handle that listens scroll shared event emitter proxy.\n\t\t * @type {EventHandle}\n\t\t * @protected\n\t\t */\n\t\tthis.scrollHandle_ = Affix.emitter_.on('scroll', this.checkPosition.bind(this));\n\n\t\tthis.on('elementChanged', this.checkPosition);\n\t\tthis.on('offsetTopChanged', this.checkPosition);\n\t\tthis.on('offsetBottomChanged', this.checkPosition);\n\t\tthis.checkPosition();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdisposeInternal() {\n\t\tdom.removeClasses(this.element, Affix.Position.Bottom + ' ' + Affix.Position.Default + ' ' + Affix.Position.Top);\n\t\tthis.scrollHandle_.dispose();\n\t\tsuper.disposeInternal();\n\t}\n\n\t/**\n\t * Synchronize bottom, top and element regions and checks if position has\n\t * changed. If position has changed syncs position.\n\t */\n\tcheckPosition() {\n\t\tif (this.intersectTopRegion()) {\n\t\t\tthis.syncPosition(Affix.Position.Top);\n\t\t} else if (this.intersectBottomRegion()) {\n\t\t\tthis.syncPosition(Affix.Position.Bottom);\n\t\t} else {\n\t\t\tthis.syncPosition(Affix.Position.Default);\n\t\t}\n\t}\n\n\t/**\n\t * Whether the element is intersecting with bottom region defined by\n\t * offsetBottom.\n\t * @return {boolean}\n\t */\n\tintersectBottomRegion() {\n\t\tif (!core.isDef(this.offsetBottom)) {\n\t\t\treturn false;\n\t\t}\n\t\tvar clientHeight = Position.getHeight(this.scrollElement);\n\t\tvar scrollElementClientHeight = Position.getClientHeight(this.scrollElement);\n\t\treturn Position.getScrollTop(this.scrollElement) + scrollElementClientHeight >= clientHeight - this.offsetBottom;\n\t}\n\n\t/**\n\t * Whether the element is intersecting with top region defined by\n\t * offsetTop.\n\t * @return {boolean}\n\t */\n\tintersectTopRegion() {\n\t\tif (!core.isDef(this.offsetTop)) {\n\t\t\treturn false;\n\t\t}\n\t\treturn Position.getScrollTop(this.scrollElement) <= this.offsetTop;\n\t}\n\n\t/**\n\t * Synchronizes element css classes to match with the specified position.\n\t * @param {Position.Bottom|Position.Default|Position.Top} position\n\t */\n\tsyncPosition(position) {\n\t\tif (this.lastPosition_ !== position) {\n\t\t\tdom.addClasses(this.element, position);\n\t\t\tdom.removeClasses(this.element, this.lastPosition_);\n\t\t\tthis.lastPosition_ = position;\n\t\t}\n\t}\n}\n\n/**\n * Holds positions enum.\n * @enum {string}\n */\nAffix.Position = {\n\tTop: 'affix-top',\n\tBottom: 'affix-bottom',\n\tDefault: 'affix'\n};\n\nAffix.STATE = {\n\t/**\n\t * The scrollElement element to be used as scrollElement area for affix. The scrollElement is\n\t * where the scroll event is listened from.\n\t * @type {Element|Window}\n\t */\n\tscrollElement: {\n\t\tsetter: dom.toElement,\n\t\tvalue: document\n\t},\n\n\t/**\n\t * Defines the offset bottom that triggers affix.\n\t * @type {number}\n\t */\n\toffsetTop: {\n\t\tvalidator: core.isNumber\n\t},\n\n\t/**\n\t * Defines the offset top that triggers affix.\n\t * @type {number}\n\t */\n\toffsetBottom: {\n\t\tvalidator: core.isNumber\n\t},\n\n\t/**\n\t * Element to be used as alignment reference of affix.\n\t * @type {Element}\n\t */\n\telement: {\n\t\tsetter: dom.toElement\n\t}\n};\n\nexport default Affix;\nimport JQueryAdapter from 'metal-jquery-adapter/src/JQueryAdapter';JQueryAdapter.register('affix', Affix);"]}